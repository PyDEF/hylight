<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="hylight.crystal package" href="hylight.crystal.html" /><link rel="prev" title="BaZrO3:Ti study" href="../tutorial/tutorial.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>hylight package - Hylight 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Hylight 1.0.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Hylight 1.0.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/tutorial.html">BaZrO3:Ti study</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current has-children current-page"><a class="current reference internal" href="#">hylight package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of hylight package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="hylight.crystal.html">hylight.crystal package</a></li>
<li class="toctree-l2"><a class="reference internal" href="hylight.findiff.html">hylight.findiff package</a></li>
<li class="toctree-l2"><a class="reference internal" href="hylight.jmol.html">hylight.jmol package</a></li>
<li class="toctree-l2"><a class="reference internal" href="hylight.phonopy.html">hylight.phonopy package</a></li>
<li class="toctree-l2"><a class="reference internal" href="hylight.vasp.html">hylight.vasp package</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="module-hylight">
<span id="hylight-package"></span><h1>hylight package<a class="headerlink" href="#module-hylight" title="Link to this heading">#</a></h1>
<p>The Hylight package.</p>
<p>Copyright (c) 2024, Théo Cavignac &lt;<a class="reference external" href="mailto:theo&#46;cavignac+dev&#37;&#52;&#48;gmail&#46;com">theo<span>&#46;</span>cavignac+dev<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;, The PyDEF team &lt;<a class="reference external" href="mailto:camille&#46;latouche&#37;&#52;&#48;cnrs-imn&#46;fr">camille<span>&#46;</span>latouche<span>&#64;</span>cnrs-imn<span>&#46;</span>fr</a>&gt;
Licensed under the EUPL</p>
<dl class="py function">
<dt class="sig sig-object py" id="hylight.setup_logging">
<span class="sig-prename descclassname"><span class="pre">hylight.</span></span><span class="sig-name descname"><span class="pre">setup_logging</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hylight.setup_logging" title="Link to this definition">#</a></dt>
<dd><p>Setup module logging.</p>
</dd></dl>

<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="hylight.crystal.html">hylight.crystal package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hylight.crystal.html#module-hylight.crystal.common">hylight.crystal.common module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hylight.crystal.html#hylight.crystal.common.CrystalOut"><code class="docutils literal notranslate"><span class="pre">CrystalOut</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="hylight.crystal.html#hylight.crystal.common.CrystalOut.from_file"><code class="docutils literal notranslate"><span class="pre">CrystalOut.from_file()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hylight.crystal.html#module-hylight.crystal.loader">hylight.crystal.loader module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hylight.crystal.html#hylight.crystal.loader.load_phonons"><code class="docutils literal notranslate"><span class="pre">load_phonons()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hylight.crystal.html#hylight.crystal.loader.normalize"><code class="docutils literal notranslate"><span class="pre">normalize()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hylight.findiff.html">hylight.findiff package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hylight.findiff.html#module-hylight.findiff.collect">hylight.findiff.collect module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hylight.findiff.html#hylight.findiff.collect.dropwhile_err"><code class="docutils literal notranslate"><span class="pre">dropwhile_err()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hylight.findiff.html#hylight.findiff.collect.get_forces"><code class="docutils literal notranslate"><span class="pre">get_forces()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hylight.findiff.html#hylight.findiff.collect.get_forces_and_pos"><code class="docutils literal notranslate"><span class="pre">get_forces_and_pos()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hylight.findiff.html#hylight.findiff.collect.get_ref_info"><code class="docutils literal notranslate"><span class="pre">get_ref_info()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hylight.findiff.html#hylight.findiff.collect.process_phonons"><code class="docutils literal notranslate"><span class="pre">process_phonons()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hylight.findiff.html#module-hylight.findiff.gen">hylight.findiff.gen module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hylight.findiff.html#hylight.findiff.gen.gen_disp"><code class="docutils literal notranslate"><span class="pre">gen_disp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hylight.findiff.html#hylight.findiff.gen.random_basis"><code class="docutils literal notranslate"><span class="pre">random_basis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hylight.findiff.html#hylight.findiff.gen.save_disp"><code class="docutils literal notranslate"><span class="pre">save_disp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hylight.findiff.html#hylight.findiff.gen.save_disp_from_basis"><code class="docutils literal notranslate"><span class="pre">save_disp_from_basis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hylight.findiff.html#hylight.findiff.gen.save_random_disp"><code class="docutils literal notranslate"><span class="pre">save_random_disp()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hylight.jmol.html">hylight.jmol package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hylight.jmol.html#hylight.jmol.export"><code class="docutils literal notranslate"><span class="pre">export()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hylight.jmol.html#hylight.jmol.export_disp"><code class="docutils literal notranslate"><span class="pre">export_disp()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hylight.jmol.html#hylight.jmol.format_v"><code class="docutils literal notranslate"><span class="pre">format_v()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hylight.jmol.html#hylight.jmol.write_jmol_options"><code class="docutils literal notranslate"><span class="pre">write_jmol_options()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hylight.jmol.html#hylight.jmol.write_xyz"><code class="docutils literal notranslate"><span class="pre">write_xyz()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hylight.phonopy.html">hylight.phonopy package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hylight.phonopy.html#module-hylight.phonopy.loader">hylight.phonopy.loader module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hylight.phonopy.html#hylight.phonopy.loader.PPStruct"><code class="docutils literal notranslate"><span class="pre">PPStruct</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="hylight.phonopy.html#hylight.phonopy.loader.PPStruct.atoms"><code class="docutils literal notranslate"><span class="pre">PPStruct.atoms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="hylight.phonopy.html#hylight.phonopy.loader.PPStruct.from_yaml_cell"><code class="docutils literal notranslate"><span class="pre">PPStruct.from_yaml_cell()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="hylight.phonopy.html#hylight.phonopy.loader.PPStruct.lattice"><code class="docutils literal notranslate"><span class="pre">PPStruct.lattice</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="hylight.phonopy.html#hylight.phonopy.loader.PPStruct.masses"><code class="docutils literal notranslate"><span class="pre">PPStruct.masses</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="hylight.phonopy.html#hylight.phonopy.loader.PPStruct.pops"><code class="docutils literal notranslate"><span class="pre">PPStruct.pops</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="hylight.phonopy.html#hylight.phonopy.loader.PPStruct.ref"><code class="docutils literal notranslate"><span class="pre">PPStruct.ref</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hylight.phonopy.html#hylight.phonopy.loader.get_struct"><code class="docutils literal notranslate"><span class="pre">get_struct()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hylight.phonopy.html#hylight.phonopy.loader.load_phonons"><code class="docutils literal notranslate"><span class="pre">load_phonons()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hylight.phonopy.html#hylight.phonopy.loader.load_phonons_bandsh5"><code class="docutils literal notranslate"><span class="pre">load_phonons_bandsh5()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hylight.phonopy.html#hylight.phonopy.loader.load_phonons_bandyaml"><code class="docutils literal notranslate"><span class="pre">load_phonons_bandyaml()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hylight.phonopy.html#hylight.phonopy.loader.load_phonons_qpointsh5"><code class="docutils literal notranslate"><span class="pre">load_phonons_qpointsh5()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hylight.phonopy.html#hylight.phonopy.loader.load_phonons_qpointsyaml"><code class="docutils literal notranslate"><span class="pre">load_phonons_qpointsyaml()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hylight.vasp.html">hylight.vasp package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hylight.vasp.html#module-hylight.vasp.common">hylight.vasp.common module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hylight.vasp.html#hylight.vasp.common.Poscar"><code class="docutils literal notranslate"><span class="pre">Poscar</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="hylight.vasp.html#hylight.vasp.common.Poscar.from_file"><code class="docutils literal notranslate"><span class="pre">Poscar.from_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="hylight.vasp.html#hylight.vasp.common.Poscar.to_file"><code class="docutils literal notranslate"><span class="pre">Poscar.to_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="hylight.vasp.html#hylight.vasp.common.Poscar.to_stream"><code class="docutils literal notranslate"><span class="pre">Poscar.to_stream()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hylight.vasp.html#module-hylight.vasp.loader">hylight.vasp.loader module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hylight.vasp.html#hylight.vasp.loader.load_phonons"><code class="docutils literal notranslate"><span class="pre">load_phonons()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hylight.vasp.html#hylight.vasp.loader.load_poscar"><code class="docutils literal notranslate"><span class="pre">load_poscar()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hylight.vasp.html#hylight.vasp.loader.load_poscar_latt"><code class="docutils literal notranslate"><span class="pre">load_poscar_latt()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hylight.vasp.html#module-hylight.vasp.utils">hylight.vasp.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hylight.vasp.html#hylight.vasp.utils.make_finite_diff_poscar"><code class="docutils literal notranslate"><span class="pre">make_finite_diff_poscar()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<section id="module-hylight.constants">
<span id="hylight-constants-module"></span><h2>hylight.constants module<a class="headerlink" href="#module-hylight.constants" title="Link to this heading">#</a></h2>
<p>A collection of useful physics constants.</p>
</section>
<section id="module-hylight.guess_width">
<span id="hylight-guess-width-module"></span><h2>hylight.guess_width module<a class="headerlink" href="#module-hylight.guess_width" title="Link to this heading">#</a></h2>
<p>Semi classical guess of linewidth.</p>
<dl class="py class">
<dt class="sig sig-object py" id="hylight.guess_width.OmegaEff">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hylight.guess_width.</span></span><span class="sig-name descname"><span class="pre">OmegaEff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.guess_width.OmegaEff" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Mode of computation of a effective frequency.</p>
<p><a class="reference internal" href="#hylight.guess_width.OmegaEff.FC_MEAN" title="hylight.guess_width.OmegaEff.FC_MEAN"><code class="xref py py-attr docutils literal notranslate"><span class="pre">FC_MEAN</span></code></a>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\Omega = \frac{\sum_j \omega_j d^\text{FC}_j}{\sum_j d^\text{FC}_j}\]</div>
</div>
<p>Should be used with <a class="reference internal" href="#hylight.guess_width.WidthModel.ONED" title="hylight.guess_width.WidthModel.ONED"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WidthModel.ONED</span></code></a> because it is associated with
the idea that all the directions are softened equally in the excited state.</p>
<p><a class="reference internal" href="#hylight.guess_width.OmegaEff.HR_MEAN" title="hylight.guess_width.OmegaEff.HR_MEAN"><code class="xref py py-attr docutils literal notranslate"><span class="pre">HR_MEAN</span></code></a>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\Omega = \frac{d^\text{FC}}{S_\text{tot}} = \frac{\sum_j \omega_j S_j}{\sum_j S_j}\]</div>
</div>
<p><a class="reference internal" href="#hylight.guess_width.OmegaEff.HR_RMS" title="hylight.guess_width.OmegaEff.HR_RMS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">HR_RMS</span></code></a>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\Omega = \sqrt{\frac{\sum_j \omega_j^2 S_j}{\sum_j S_j}}\]</div>
</div>
<p><a class="reference internal" href="#hylight.guess_width.OmegaEff.FC_RMS" title="hylight.guess_width.OmegaEff.FC_RMS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">FC_RMS</span></code></a>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\Omega = \sqrt{\frac{\sum_j \omega_j^2 d^\text{FC}_j}{\sum_j d^\text{FC}_j}}\]</div>
</div>
<p>Should be used with <a class="reference internal" href="#hylight.guess_width.WidthModel.SINGLE_ES_FREQ" title="hylight.guess_width.WidthModel.SINGLE_ES_FREQ"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WidthModel.SINGLE_ES_FREQ</span></code></a> because it makes sense
when we get only one Omega_eff for the excited state (this single
effective frequency should be computed beforehand)</p>
<p><a class="reference internal" href="#hylight.guess_width.OmegaEff.GRAD" title="hylight.guess_width.OmegaEff.GRAD"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GRAD</span></code></a>:</p>
<p>The effective frequency of GS is computed in the direction of the gradiant
of GS PES at the ES position.
The effective frequency for the ES is provided by the user (and should be computed in the same direction).
Should be used with <a class="reference internal" href="#hylight.guess_width.WidthModel.ONED" title="hylight.guess_width.WidthModel.ONED"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WidthModel.ONED</span></code></a>.</p>
<p><a class="reference internal" href="#hylight.guess_width.OmegaEff.DISP" title="hylight.guess_width.OmegaEff.DISP"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DISP</span></code></a>:</p>
<p>The effective frequency of GS is computed in the direction of the displacement.
The effective frequency for the ES is provided by the user (and should be computed in the same direction).
Should be used with <a class="reference internal" href="#hylight.guess_width.WidthModel.ONED" title="hylight.guess_width.WidthModel.ONED"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WidthModel.ONED</span></code></a>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="hylight.guess_width.OmegaEff.DISP">
<span class="sig-name descname"><span class="pre">DISP</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#hylight.guess_width.OmegaEff" title="hylight.guess_width.OmegaEff"><span class="pre">OmegaEff</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;hylight.guess_width.OmegaEff</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#hylight.guess_width.OmegaEff.DISP" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hylight.guess_width.OmegaEff.FC_MEAN">
<span class="sig-name descname"><span class="pre">FC_MEAN</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#hylight.guess_width.OmegaEff" title="hylight.guess_width.OmegaEff"><span class="pre">OmegaEff</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;hylight.guess_width.OmegaEff</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#hylight.guess_width.OmegaEff.FC_MEAN" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hylight.guess_width.OmegaEff.FC_RMS">
<span class="sig-name descname"><span class="pre">FC_RMS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#hylight.guess_width.OmegaEff" title="hylight.guess_width.OmegaEff"><span class="pre">OmegaEff</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;hylight.guess_width.OmegaEff</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#hylight.guess_width.OmegaEff.FC_RMS" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hylight.guess_width.OmegaEff.GRAD">
<span class="sig-name descname"><span class="pre">GRAD</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#hylight.guess_width.OmegaEff" title="hylight.guess_width.OmegaEff"><span class="pre">OmegaEff</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;hylight.guess_width.OmegaEff</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#hylight.guess_width.OmegaEff.GRAD" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hylight.guess_width.OmegaEff.HR_MEAN">
<span class="sig-name descname"><span class="pre">HR_MEAN</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#hylight.guess_width.OmegaEff" title="hylight.guess_width.OmegaEff"><span class="pre">OmegaEff</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;hylight.guess_width.OmegaEff</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#hylight.guess_width.OmegaEff.HR_MEAN" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hylight.guess_width.OmegaEff.HR_RMS">
<span class="sig-name descname"><span class="pre">HR_RMS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#hylight.guess_width.OmegaEff" title="hylight.guess_width.OmegaEff"><span class="pre">OmegaEff</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;hylight.guess_width.OmegaEff</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#hylight.guess_width.OmegaEff.HR_RMS" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hylight.guess_width.WidthModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hylight.guess_width.</span></span><span class="sig-name descname"><span class="pre">WidthModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.guess_width.WidthModel" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>Mode of approximation of the band width.</p>
<p><a class="reference internal" href="#hylight.guess_width.WidthModel.ONED" title="hylight.guess_width.WidthModel.ONED"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ONED</span></code></a>: The witdth is computed in a 1D mode for both ES and GS.</p>
<p><a class="reference internal" href="#hylight.guess_width.WidthModel.SINGLE_ES_FREQ" title="hylight.guess_width.WidthModel.SINGLE_ES_FREQ"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SINGLE_ES_FREQ</span></code></a>: We suppose all modes of the ES have the same
frequency (that should be provided).</p>
<p><a class="reference internal" href="#hylight.guess_width.WidthModel.FULL_ND" title="hylight.guess_width.WidthModel.FULL_ND"><code class="xref py py-attr docutils literal notranslate"><span class="pre">FULL_ND</span></code></a>: (Not implemented) We know the frequency of each ES mode.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="hylight.guess_width.WidthModel.FULL_ND">
<span class="sig-name descname"><span class="pre">FULL_ND</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#hylight.guess_width.WidthModel.FULL_ND" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hylight.guess_width.WidthModel.ONED">
<span class="sig-name descname"><span class="pre">ONED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#hylight.guess_width.WidthModel.ONED" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hylight.guess_width.WidthModel.SINGLE_ES_FREQ">
<span class="sig-name descname"><span class="pre">SINGLE_ES_FREQ</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#hylight.guess_width.WidthModel.SINGLE_ES_FREQ" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.guess_width.duschinsky">
<span class="sig-prename descclassname"><span class="pre">hylight.guess_width.</span></span><span class="sig-name descname"><span class="pre">duschinsky</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phonons_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phonons_b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.guess_width.duschinsky" title="Link to this definition">#</a></dt>
<dd><p>Dushinsky matrix from b to a <span class="math notranslate nohighlight">\(S_{a \gets b}\)</span>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.guess_width.effective_phonon_energy">
<span class="sig-prename descclassname"><span class="pre">hylight.guess_width.</span></span><span class="sig-name descname"><span class="pre">effective_phonon_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">omega_eff_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">es</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masses</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.guess_width.effective_phonon_energy" title="Link to this definition">#</a></dt>
<dd><p>Compute an effective phonon energy in eV following the strategy of omega_eff_type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>omega_eff_type</strong> – The mode of evaluation of the effective phonon energy.</p></li>
<li><p><strong>hrs</strong> – The array of Huang-Rhyes factor for each mode.</p></li>
<li><p><strong>es</strong> – The array of phonon energy in eV.</p></li>
<li><p><strong>masses</strong> – The array of atomic masses in atomic mass unit.</p></li>
<li><p><strong>delta_R</strong> – The displacement between GS and ES in A.
It is only required if omega_eff_type is ONED_FREQ.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The effective energy in eV.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.guess_width.expected_width">
<span class="sig-prename descclassname"><span class="pre">hylight.guess_width.</span></span><span class="sig-name descname"><span class="pre">expected_width</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phonons</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc_shift_gs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc_shift_es</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_eff_type=&lt;hylight.guess_width.OmegaEff</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_model=WidthModel.ONED</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.guess_width.expected_width" title="Link to this definition">#</a></dt>
<dd><p>Compute a spectrum without free parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phonons</strong> – list of modes</p></li>
<li><p><strong>delta_R</strong> – displacement in A</p></li>
<li><p><strong>fc_shift_gs</strong> – Ground state/absorption Franck-Condon shift in eV</p></li>
<li><p><strong>fc_shift_es</strong> – Exceited state/emmission Franck-Condon shift in eV</p></li>
<li><p><strong>T</strong> – temperature in K</p></li>
<li><p><strong>resolution_e</strong> – energy resolution in eV</p></li>
<li><p><strong>bias</strong> – ignore low energy vibrations under bias in eV</p></li>
<li><p><strong>window_fn</strong> – windowing function in the form provided by numpy (see numpy.hamming)</p></li>
<li><p><strong>pre_convolve</strong> – (float, optional, None) if not None, standard deviation of the pre convolution gaussian</p></li>
<li><p><strong>shape</strong> – ZPL line shape.</p></li>
<li><p><strong>omega_eff_type</strong> – mode of evaluation of effective frequency.</p></li>
<li><p><strong>result_store</strong> – a dictionary to store some intermediate results.</p></li>
<li><p><strong>ex_pes</strong> – mode of evaluation of the ES PES curvature.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="code docutils literal notranslate"><span class="pre">(sig(T=0),</span> <span class="pre">sig(T))</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.guess_width.gradiant_at">
<span class="sig-prename descclassname"><span class="pre">hylight.guess_width.</span></span><span class="sig-name descname"><span class="pre">gradiant_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_R</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.guess_width.gradiant_at" title="Link to this definition">#</a></dt>
<dd><p>Compute the gradient of the PES at the position of delta_R.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>modes</strong> – list of modes</p></li>
<li><p><strong>masses</strong> – list of atomic masses</p></li>
<li><p><strong>delta_R</strong> – displacement of each atoms in A</p></li>
<li><p><strong>mask</strong> – (optional, None) a <a class="reference internal" href="#hylight.mode.Mask" title="hylight.mode.Mask"><code class="xref py py-class docutils literal notranslate"><span class="pre">hylight.mode.Mask</span></code></a> used to discard irrelevant modes</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the gradient of the PES at the position of delta_R</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.guess_width.guess_width">
<span class="sig-prename descclassname"><span class="pre">hylight.guess_width.</span></span><span class="sig-name descname"><span class="pre">guess_width</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phonons</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc_shift_gs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc_shift_es</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution_e=0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape=LineShape.GAUSSIAN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_eff_type=&lt;hylight.guess_width.OmegaEff</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_model=WidthModel.ONED</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_fn=&lt;function</span> <span class="pre">hamming&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial_line_sig=0.02</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.guess_width.guess_width" title="Link to this definition">#</a></dt>
<dd><p>Try to guess the width of the line from a 1D semi-classical model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phonons</strong> – list of modes (see <code class="xref py py-func docutils literal notranslate"><span class="pre">load_phonons()</span></code>) or path to load the modes</p></li>
<li><p><strong>delta_R</strong> – displacement in A in a numpy array (see <code class="xref py py-func docutils literal notranslate"><span class="pre">compute_delta_R()</span></code>)
or tuple of two paths <code class="code docutils literal notranslate"><span class="pre">(pos_gs,</span> <span class="pre">pos_es)</span></code></p></li>
<li><p><strong>fc_shift_gs</strong> – Ground state/absorption Franck-Condon shift in eV</p></li>
<li><p><strong>fc_shift_es</strong> – Exceited state/emmission Franck-Condon shift in eV</p></li>
<li><p><strong>T</strong> – temperature in K</p></li>
<li><p><strong>resolution_e</strong> – energy resolution in eV</p></li>
<li><p><strong>mask</strong> – a mask used in other computations to show on the plot.</p></li>
<li><p><strong>shape</strong> – the lineshape (a <code class="xref py py-class docutils literal notranslate"><span class="pre">LineShape</span></code> instance)</p></li>
<li><p><strong>omega_eff_type</strong> – mode of evaluation of effective frequency.</p></li>
<li><p><strong>ex_pes</strong> – mode of evaluation of the ES PES curvature.</p></li>
<li><p><strong>window_fn</strong> – windowing function in the form provided by numpy (see numpy.hamming)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a guess width in eV</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.guess_width.integrate">
<span class="sig-prename descclassname"><span class="pre">hylight.guess_width.</span></span><span class="sig-name descname"><span class="pre">integrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.guess_width.integrate" title="Link to this definition">#</a></dt>
<dd><p>Integrate a function over x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> of x values</p></li>
<li><p><strong>y</strong> – <code class="code docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">f(x)</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="math notranslate nohighlight">\(\int f(x) dx\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.guess_width.sigma">
<span class="sig-prename descclassname"><span class="pre">hylight.guess_width.</span></span><span class="sig-name descname"><span class="pre">sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_em</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_phonon_g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_phonon_e</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.guess_width.sigma" title="Link to this definition">#</a></dt>
<dd><p>Temperature dependant standard deviation of the lineshape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> – temperature in K</p></li>
<li><p><strong>S_em</strong> – emmission Huang-Rhys factor</p></li>
<li><p><strong>e_phonon_g</strong> – energy of the GS PES vibration (eV)</p></li>
<li><p><strong>e_phonon_e</strong> – energy of the ES PES vibration (eV)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.guess_width.sigma_full_nd">
<span class="sig-prename descclassname"><span class="pre">hylight.guess_width.</span></span><span class="sig-name descname"><span class="pre">sigma_full_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modes_gs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modes_es</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.guess_width.sigma_full_nd" title="Link to this definition">#</a></dt>
<dd><p>Compute the width of the ZPL for the <code class="xref py py-attr docutils literal notranslate"><span class="pre">ExPES.FULL_ND</span></code> mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> – temperature in K.</p></li>
<li><p><strong>delta_R</strong> – distorsion in A.</p></li>
<li><p><strong>modes_gs</strong> – list of Modes of the ground state.</p></li>
<li><p><strong>modes_es</strong> – list of Modes of the excited state.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> with only the width for the modes that are real in ground state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.guess_width.sigma_hybrid">
<span class="sig-prename descclassname"><span class="pre">hylight.guess_width.</span></span><span class="sig-name descname"><span class="pre">sigma_hybrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_phonon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_phonon_e</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.guess_width.sigma_hybrid" title="Link to this definition">#</a></dt>
<dd><p>Compute the width of the ZPL for the <code class="xref py py-attr docutils literal notranslate"><span class="pre">ExPES.SINGLE_ES_FREQ</span></code> mode.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.guess_width.variance">
<span class="sig-prename descclassname"><span class="pre">hylight.guess_width.</span></span><span class="sig-name descname"><span class="pre">variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.guess_width.variance" title="Link to this definition">#</a></dt>
<dd><p>Compute the variance of a random variable of distribution y.</p>
</dd></dl>

</section>
<section id="module-hylight.loader">
<span id="hylight-loader-module"></span><h2>hylight.loader module<a class="headerlink" href="#module-hylight.loader" title="Link to this heading">#</a></h2>
<p>Wrapper for the npz loader.</p>
</section>
<section id="module-hylight.mode">
<span id="hylight-mode-module"></span><h2>hylight.mode module<a class="headerlink" href="#module-hylight.mode" title="Link to this heading">#</a></h2>
<p>Vibrational mode and related utilities.</p>
<dl class="py class">
<dt class="sig sig-object py" id="hylight.mode.CellMismatch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hylight.mode.</span></span><span class="sig-name descname"><span class="pre">CellMismatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reason</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">details</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.mode.CellMismatch" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A falsy value explaining how the cell are not matching.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hylight.mode.Mask">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hylight.mode.</span></span><span class="sig-name descname"><span class="pre">Mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.mode.Mask" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>An energy based mask for the set of modes.</p>
<dl class="py method">
<dt class="sig sig-object py" id="hylight.mode.Mask.accept">
<span class="sig-name descname"><span class="pre">accept</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#hylight.mode.Mask.accept" title="Link to this definition">#</a></dt>
<dd><p>Return True if value is not under the mask.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.mode.Mask.add_interval">
<span class="sig-name descname"><span class="pre">add_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#hylight.mode.Mask.add_interval" title="Link to this definition">#</a></dt>
<dd><p>Add a new interval to the mask.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.mode.Mask.as_bool">
<span class="sig-name descname"><span class="pre">as_bool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ener</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#hylight.mode.Mask.as_bool" title="Link to this definition">#</a></dt>
<dd><p>Convert to a boolean <cite>np.ndarray</cite> based on <cite>ener</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.mode.Mask.from_bias">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#hylight.mode.Mask" title="hylight.mode.Mask"><span class="pre">Mask</span></a></span></span><a class="headerlink" href="#hylight.mode.Mask.from_bias" title="Link to this definition">#</a></dt>
<dd><p>Create a mask that reject modes of energy between 0 and <cite>bias</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bias</strong> – minimum of accepted energy (eV)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a fresh instance of <cite>Mask</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.mode.Mask.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.mode.Mask.plot" title="Link to this definition">#</a></dt>
<dd><p>Add a graphical representation of the mask to a plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – a matplotlib <cite>Axes</cite> object.</p></li>
<li><p><strong>unit</strong> – the unit of energy to use (ex: <code class="xref py py-attr docutils literal notranslate"><span class="pre">hylight.constant.eV_in_J</span></code> if the plot uses eV)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a function that must be called without arguments after resizing the plot.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.mode.Mask.reject">
<span class="sig-name descname"><span class="pre">reject</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#hylight.mode.Mask.reject" title="Link to this definition">#</a></dt>
<dd><p>Return True if <cite>value</cite> is under the mask.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hylight.mode.Mode">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hylight.mode.</span></span><span class="sig-name descname"><span class="pre">Mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lattice</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvector</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masses</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.mode.Mode" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The representation of a vibrational mode.</p>
<p>It stores the eigenvector and eigendisplacement.
It can be used to project other displacement on the eigenvector.</p>
<dl class="py method">
<dt class="sig sig-object py" id="hylight.mode.Mode.energies">
<span class="sig-name descname"><span class="pre">energies</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hylight.mode.Mode.energies" title="Link to this definition">#</a></dt>
<dd><p>Return the energy participation of each atom to the mode.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hylight.mode.Mode.energy_cm1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">energy_cm1</span></span><a class="headerlink" href="#hylight.mode.Mode.energy_cm1" title="Link to this definition">#</a></dt>
<dd><p>Energy of the mode in <span class="math notranslate nohighlight">\(cm^{-1}\)</span>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hylight.mode.Mode.energy_eV">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">energy_eV</span></span><a class="headerlink" href="#hylight.mode.Mode.energy_eV" title="Link to this definition">#</a></dt>
<dd><p>Energy of the mode in eV.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hylight.mode.Mode.energy_meV">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">energy_meV</span></span><a class="headerlink" href="#hylight.mode.Mode.energy_meV" title="Link to this definition">#</a></dt>
<dd><p>Energy of the mode in meV.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hylight.mode.Mode.energy_si">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">energy_si</span></span><a class="headerlink" href="#hylight.mode.Mode.energy_si" title="Link to this definition">#</a></dt>
<dd><p>Energy of the mode in J.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.mode.Mode.huang_rhys">
<span class="sig-name descname"><span class="pre">huang_rhys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta_R</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#hylight.mode.Mode.huang_rhys" title="Link to this definition">#</a></dt>
<dd><p>Compute the Huang-Rhyes factor.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[S_i = 1/2 \frac{\omega}{\hbar} [({M^{1/2}}^T \Delta R) \cdot \gamma_i]^2
= 1/2 \frac{\omega}{\hbar} {\sum_i m_i^{1/2} \gamma_i {\Delta R}_i}^2\]</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>delta_R</strong> – displacement in SI</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.mode.Mode.localization_ratio">
<span class="sig-name descname"><span class="pre">localization_ratio</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hylight.mode.Mode.localization_ratio" title="Link to this definition">#</a></dt>
<dd><p>Quantify the localization of the mode over the supercell.</p>
<p>See also <a class="reference internal" href="#hylight.mode.Mode.participation_ratio" title="hylight.mode.Mode.participation_ratio"><code class="xref py py-func docutils literal notranslate"><span class="pre">participation_ratio()</span></code></a>.</p>
<p>1: fully delocalized
&gt;&gt; 1: localized</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.mode.Mode.participation_ratio">
<span class="sig-name descname"><span class="pre">participation_ratio</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hylight.mode.Mode.participation_ratio" title="Link to this definition">#</a></dt>
<dd><p>Fraction of atoms active in the mode.</p>
<p>R J Bell et al 1970 J. Phys. C: Solid State Phys. 3 2111
<a class="reference external" href="https://doi.org/10.1088/0022-3719/3/10/013">https://doi.org/10.1088/0022-3719/3/10/013</a></p>
<p>It is equal to <span class="math notranslate nohighlight">\(M_1^2 / (M_2 M_0)\)</span> where</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[M_n = \sum_\alpha {m_\alpha {||\eta_\alpha||}^2}^n\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\eta_\alpha\)</span> is the contribution of atom <span class="math notranslate nohighlight">\(\alpha\)</span> to
eigendisplacement <span class="math notranslate nohighlight">\(\eta\)</span>.</p>
<p>But <span class="math notranslate nohighlight">\(M_0 = N\)</span> by definition and <span class="math notranslate nohighlight">\(M_1 = 1\)</span> because the eigenvectors are normalized.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><span class="math notranslate nohighlight">\(M_n\)</span> = <code class="code docutils literal notranslate"><span class="pre">np.sum(self.energies()**n)</span></code></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.mode.Mode.per_species_n_eff">
<span class="sig-name descname"><span class="pre">per_species_n_eff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.mode.Mode.per_species_n_eff" title="Link to this definition">#</a></dt>
<dd><p>Compute the number of atoms participating to the mode for a given species.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.mode.Mode.per_species_pr">
<span class="sig-name descname"><span class="pre">per_species_pr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.mode.Mode.per_species_pr" title="Link to this definition">#</a></dt>
<dd><p>Compute the fraction of atoms participation to the mode for a given species.</p>
<p>See also <a class="reference internal" href="#hylight.mode.Mode.per_species_n_eff" title="hylight.mode.Mode.per_species_n_eff"><code class="xref py py-func docutils literal notranslate"><span class="pre">per_species_n_eff()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.mode.Mode.project">
<span class="sig-name descname"><span class="pre">project</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta_Q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#hylight.mode.Mode.project" title="Link to this definition">#</a></dt>
<dd><p>Project delta_Q onto the eigenvector.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.mode.Mode.project_coef2">
<span class="sig-name descname"><span class="pre">project_coef2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta_Q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#hylight.mode.Mode.project_coef2" title="Link to this definition">#</a></dt>
<dd><p>Square lenght of the projection of delta_Q onto the eigenvector.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.mode.Mode.project_coef2_R">
<span class="sig-name descname"><span class="pre">project_coef2_R</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta_R</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#hylight.mode.Mode.project_coef2_R" title="Link to this definition">#</a></dt>
<dd><p>Square lenght of the projection of delta_R onto the eigenvector.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.mode.Mode.set_lattice">
<span class="sig-name descname"><span class="pre">set_lattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lattice</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#hylight.mode.Mode.set_lattice" title="Link to this definition">#</a></dt>
<dd><p>Change the representation to another lattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lattice</strong> – 3x3 matrix representing lattice vectors <code class="code docutils literal notranslate"><span class="pre">np.array([a,</span> <span class="pre">b,</span> <span class="pre">c])</span></code>.</p></li>
<li><p><strong>tol</strong> – numerical tolerance for vectors mismatch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.mode.Mode.to_jmol">
<span class="sig-name descname"><span class="pre">to_jmol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dest</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">opts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.mode.Mode.to_jmol" title="Link to this definition">#</a></dt>
<dd><p>Write a mode into a Jmol file.</p>
<p>See <a class="reference internal" href="hylight.jmol.html#hylight.jmol.export" title="hylight.jmol.export"><code class="xref py py-func docutils literal notranslate"><span class="pre">hylight.jmol.export()</span></code></a> for the parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.mode.Mode.to_traj">
<span class="sig-name descname"><span class="pre">to_traj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">framerate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.mode.Mode.to_traj" title="Link to this definition">#</a></dt>
<dd><p>Produce a ase trajectory for animation purpose.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>duration</strong> – duration of the animation in seconds</p></li>
<li><p><strong>amplitude</strong> – amplitude applied to the mode in A (the modes are normalized)</p></li>
<li><p><strong>framerate</strong> – number of frame per second of animation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.mode.angle">
<span class="sig-prename descclassname"><span class="pre">hylight.mode.</span></span><span class="sig-name descname"><span class="pre">angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.mode.angle" title="Link to this definition">#</a></dt>
<dd><p>Compute the angle in radians between two 3D vectors.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.mode.dynamical_matrix">
<span class="sig-prename descclassname"><span class="pre">hylight.mode.</span></span><span class="sig-name descname"><span class="pre">dynamical_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phonons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hylight.mode.Mode" title="hylight.mode.Mode"><span class="pre">Mode</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#hylight.mode.dynamical_matrix" title="Link to this definition">#</a></dt>
<dd><p>Retrieve the dynamical matrix from a set of modes.</p>
<p>Note that if some modes are missing the computation will fail.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>phonons</strong> – list of modes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.mode.generate_basis">
<span class="sig-prename descclassname"><span class="pre">hylight.mode.</span></span><span class="sig-name descname"><span class="pre">generate_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.mode.generate_basis" title="Link to this definition">#</a></dt>
<dd><p>Generate an orthonormal basis with the rows of seed as first rows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seed</strong> – the starting vectors, a <code class="code docutils literal notranslate"><span class="pre">(m,</span> <span class="pre">n)</span></code> matrix of orthonormal rows.
<code class="code docutils literal notranslate"><span class="pre">m</span> <span class="pre">=</span> <span class="pre">0</span></code> is valid and will create a random basis.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a <code class="code docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">n)</span></code> orthonormal basis where the first <code class="code docutils literal notranslate"><span class="pre">m</span></code> rows
are the rows of <code class="code docutils literal notranslate"><span class="pre">seed</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.mode.get_HR_factors">
<span class="sig-prename descclassname"><span class="pre">hylight.mode.</span></span><span class="sig-name descname"><span class="pre">get_HR_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phonons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hylight.mode.Mode" title="hylight.mode.Mode"><span class="pre">Mode</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_R_tot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#hylight.mode.Mask" title="hylight.mode.Mask"><span class="pre">Mask</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#hylight.mode.get_HR_factors" title="Link to this definition">#</a></dt>
<dd><p>Compute the Huang-Rhys factors for all the real modes with energy above bias.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phonons</strong> – list of modes</p></li>
<li><p><strong>delta_R_tot</strong> – displacement in SI</p></li>
<li><p><strong>mask</strong> – a mask to filter modes based on their energies.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.mode.get_energies">
<span class="sig-prename descclassname"><span class="pre">hylight.mode.</span></span><span class="sig-name descname"><span class="pre">get_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phonons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hylight.mode.Mode" title="hylight.mode.Mode"><span class="pre">Mode</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#hylight.mode.Mask" title="hylight.mode.Mask"><span class="pre">Mask</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#hylight.mode.get_energies" title="Link to this definition">#</a></dt>
<dd><p>Return an array of mode energies in SI.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.mode.modes_from_dynmat">
<span class="sig-prename descclassname"><span class="pre">hylight.mode.</span></span><span class="sig-name descname"><span class="pre">modes_from_dynmat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynmat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.mode.modes_from_dynmat" title="Link to this definition">#</a></dt>
<dd><p>Compute vibrational modes from the dynamical matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lattice</strong> – lattice parameters (3 x 3 <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>)</p></li>
<li><p><strong>atoms</strong> – list of atoms</p></li>
<li><p><strong>masses</strong> – list of atom masses</p></li>
<li><p><strong>ref</strong> – reference position</p></li>
<li><p><strong>dynmat</strong> – dynamical matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of <a class="reference internal" href="#hylight.mode.Mode" title="hylight.mode.Mode"><code class="xref py py-class docutils literal notranslate"><span class="pre">hylight.mode.Mode</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.mode.orthonormalize">
<span class="sig-prename descclassname"><span class="pre">hylight.mode.</span></span><span class="sig-name descname"><span class="pre">orthonormalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.mode.orthonormalize" title="Link to this definition">#</a></dt>
<dd><p>Ensure that the vectors of m are orthonormal.</p>
<p>Change the rows from n_seed up inplace to make them orthonormal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> – the starting vectors</p></li>
<li><p><strong>n_seed</strong> – number of first rows to not change.
They must be orthonormal already.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.mode.project_on_asr">
<span class="sig-prename descclassname"><span class="pre">hylight.mode.</span></span><span class="sig-name descname"><span class="pre">project_on_asr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masses</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.mode.project_on_asr" title="Link to this definition">#</a></dt>
<dd><p>Enforce accoustic sum rule.</p>
<p>Project the input matrix on the space of ASR abiding matrices and return
the projections.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.mode.rot_c_to_v">
<span class="sig-prename descclassname"><span class="pre">hylight.mode.</span></span><span class="sig-name descname"><span class="pre">rot_c_to_v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phonons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hylight.mode.Mode" title="hylight.mode.Mode"><span class="pre">Mode</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#hylight.mode.rot_c_to_v" title="Link to this definition">#</a></dt>
<dd><p>Rotation matrix from Cartesian basis to Vibrational basis (right side).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.mode.same_cell">
<span class="sig-prename descclassname"><span class="pre">hylight.mode.</span></span><span class="sig-name descname"><span class="pre">same_cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#hylight.mode.CellMismatch" title="hylight.mode.CellMismatch"><span class="pre">CellMismatch</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span></span></span><a class="headerlink" href="#hylight.mode.same_cell" title="Link to this definition">#</a></dt>
<dd><p>Compare two lattice vectors matrix and return True if they describe the same cell.</p>
</dd></dl>

</section>
<section id="module-hylight.mono_phonon">
<span id="hylight-mono-phonon-module"></span><h2>hylight.mono_phonon module<a class="headerlink" href="#module-hylight.mono_phonon" title="Link to this heading">#</a></h2>
<p>Simulation of luminescence spectra in 1D model.</p>
<dl class="py function">
<dt class="sig sig-object py" id="hylight.mono_phonon.compute_spectrum">
<span class="sig-prename descclassname"><span class="pre">hylight.mono_phonon.</span></span><span class="sig-name descname"><span class="pre">compute_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e_zpl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_phonon_g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.mono_phonon.compute_spectrum" title="Link to this definition">#</a></dt>
<dd><p>Compute a spectrum from 1D model with experimental like inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e_zpl</strong> – energy of the zero phonon line, in eV</p></li>
<li><p><strong>S</strong> – the emission Huang-Rhys factor</p></li>
<li><p><strong>sig</strong> – the lineshape standard deviation</p></li>
<li><p><strong>e</strong> – (optional, None) a numpy array of energies to compute the spectrum at
if ommited, an array ranging from 0 to 3*e_zpl will be created.</p></li>
</ul>
</dd>
<dt class="field-even">E_phonon_g<span class="colon">:</span></dt>
<dd class="field-even"><p>the ground state phonon energy</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.mono_phonon.huang_rhys">
<span class="sig-prename descclassname"><span class="pre">hylight.mono_phonon.</span></span><span class="sig-name descname"><span class="pre">huang_rhys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stokes_shift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_phonon</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.mono_phonon.huang_rhys" title="Link to this definition">#</a></dt>
<dd><p>Huang-Rhys factor from the Stokes shift and the phonon energy.</p>
</dd></dl>

</section>
<section id="module-hylight.multi_phonons">
<span id="hylight-multi-phonons-module"></span><h2>hylight.multi_phonons module<a class="headerlink" href="#module-hylight.multi_phonons" title="Link to this heading">#</a></h2>
<p>Simulation of spectra in nD model.</p>
<dl class="py class">
<dt class="sig sig-object py" id="hylight.multi_phonons.LineShape">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hylight.multi_phonons.</span></span><span class="sig-name descname"><span class="pre">LineShape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.multi_phonons.LineShape" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>Line shape type.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="hylight.multi_phonons.LineShape.GAUSSIAN">
<span class="sig-name descname"><span class="pre">GAUSSIAN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#hylight.multi_phonons.LineShape.GAUSSIAN" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hylight.multi_phonons.LineShape.LORENTZIAN">
<span class="sig-name descname"><span class="pre">LORENTZIAN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#hylight.multi_phonons.LineShape.LORENTZIAN" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hylight.multi_phonons.LineShape.NONE">
<span class="sig-name descname"><span class="pre">NONE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#hylight.multi_phonons.LineShape.NONE" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.multi_phonons.compute_delta_R">
<span class="sig-prename descclassname"><span class="pre">hylight.multi_phonons.</span></span><span class="sig-name descname"><span class="pre">compute_delta_R</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">poscar_gs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poscar_es</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.multi_phonons.compute_delta_R" title="Link to this definition">#</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(\Delta R\)</span> in A.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>poscar_gs</strong> – path to ground state positions file.</p></li>
<li><p><strong>poscar_es</strong> – path to excited state positions file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> of shape <code class="code docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code> where <code class="code docutils literal notranslate"><span class="pre">n</span></code> is the number of atoms.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.multi_phonons.compute_spectrum">
<span class="sig-prename descclassname"><span class="pre">hylight.multi_phonons.</span></span><span class="sig-name descname"><span class="pre">compute_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phonons</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zpl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_max=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution_e=0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape=LineShape.GAUSSIAN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_convolve=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_phonons=&lt;function</span> <span class="pre">load_phonons&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_fn=&lt;function</span> <span class="pre">hamming&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T=0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.multi_phonons.compute_spectrum" title="Link to this definition">#</a></dt>
<dd><p>Compute a luminescence spectrum with the time-dependant formulation with an arbitrary linewidth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phonons</strong> – list of modes (see <code class="xref py py-func docutils literal notranslate"><span class="pre">load_phonons()</span></code>) or path to load the modes</p></li>
<li><p><strong>delta_R</strong> – displacement in A in a numpy array (see <a class="reference internal" href="#hylight.multi_phonons.compute_delta_R" title="hylight.multi_phonons.compute_delta_R"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_delta_R()</span></code></a>)
or tuple of two paths <code class="code docutils literal notranslate"><span class="pre">(pos_gs,</span> <span class="pre">pos_es)</span></code></p></li>
<li><p><strong>zpl</strong> – zero phonon line energy in eV</p></li>
<li><p><strong>fwhm</strong> – <p>ZPL lineshape full width at half maximum in eV or None</p>
<ul>
<li><p>if <code class="code docutils literal notranslate"><span class="pre">fwhm</span> <span class="pre">is</span> <span class="pre">None</span> <span class="pre">or</span> <span class="pre">fwhm</span> <span class="pre">==</span> <span class="pre">0.0</span></code>: the raw spectrum is provided unconvoluted</p></li>
<li><p>if <code class="code docutils literal notranslate"><span class="pre">fwhm</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>: the spectrum is convoluted with a gaussian line shape</p></li>
<li><p>if <code class="code docutils literal notranslate"><span class="pre">fwhm</span> <span class="pre">&lt;</span> <span class="pre">0</span></code>: error</p></li>
</ul>
</p></li>
<li><p><strong>e_max</strong> – (optional, <code class="code docutils literal notranslate"><span class="pre">2.5*e_zpl</span></code>) max energy in eV (should be at greater than <code class="code docutils literal notranslate"><span class="pre">2*zpl</span></code>)</p></li>
<li><p><strong>resolution_e</strong> – (optional, <code class="code docutils literal notranslate"><span class="pre">1e-3</span></code>) energy resolution in eV</p></li>
<li><p><strong>load_phonons</strong> – a function to read phonons from files.</p></li>
<li><p><strong>mask</strong> – a <a class="reference internal" href="#hylight.mode.Mask" title="hylight.mode.Mask"><code class="xref py py-class docutils literal notranslate"><span class="pre">mode.Mask</span></code></a> instance to select modes base on frequencies</p></li>
<li><p><strong>shape</strong> – the lineshape (a <a class="reference internal" href="#hylight.multi_phonons.LineShape" title="hylight.multi_phonons.LineShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">LineShape</span></code></a> instance)</p></li>
<li><p><strong>pre_convolve</strong> – (float, optional, None) if not None, standard deviation of a pre convolution gaussian</p></li>
<li><p><strong>window_fn</strong> – windowing function in the form provided by numpy (see <code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.hamming()</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="code docutils literal notranslate"><span class="pre">(energy_array,</span> <span class="pre">intensity_array)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.multi_phonons.duschinsky">
<span class="sig-prename descclassname"><span class="pre">hylight.multi_phonons.</span></span><span class="sig-name descname"><span class="pre">duschinsky</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phonons_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phonons_b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.multi_phonons.duschinsky" title="Link to this definition">#</a></dt>
<dd><p>Dushinsky matrix from b to a <span class="math notranslate nohighlight">\(S_{a \\gets b}\)</span>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.multi_phonons.dynmatshow">
<span class="sig-prename descclassname"><span class="pre">hylight.multi_phonons.</span></span><span class="sig-name descname"><span class="pre">dynmatshow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dynmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.multi_phonons.dynmatshow" title="Link to this definition">#</a></dt>
<dd><p>Plot the dynamical matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dynmat</strong> – numpy array representing the dynamical matrice in SI.</p></li>
<li><p><strong>blocks</strong> – (optional, None) a list of coloured blocks in the form
<code class="code docutils literal notranslate"><span class="pre">(label,</span> <span class="pre">number_of_atoms,</span> <span class="pre">color)</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.multi_phonons.fc_spectrum">
<span class="sig-prename descclassname"><span class="pre">hylight.multi_phonons.</span></span><span class="sig-name descname"><span class="pre">fc_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phonons</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.multi_phonons.fc_spectrum" title="Link to this definition">#</a></dt>
<dd><p>Build arrays for plotting a spectrum energy spectral function.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.multi_phonons.freq_from_finite_diff">
<span class="sig-prename descclassname"><span class="pre">hylight.multi_phonons.</span></span><span class="sig-name descname"><span class="pre">freq_from_finite_diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.multi_phonons.freq_from_finite_diff" title="Link to this definition">#</a></dt>
<dd><p>Compute a vibration energy from three energy points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left</strong> – energy (eV) of the left point</p></li>
<li><p><strong>mid</strong> – energy (eV) of the middle point</p></li>
<li><p><strong>right</strong> – energy (eV) of the right point</p></li>
<li><p><strong>mu</strong> – effective mass associated with the displacement from the middle
point to the sides.</p></li>
<li><p><strong>A</strong> – amplitude (A) of the displacement between the
middle point and the sides.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.multi_phonons.hr_spectrum">
<span class="sig-prename descclassname"><span class="pre">hylight.multi_phonons.</span></span><span class="sig-name descname"><span class="pre">hr_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phonons</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.multi_phonons.hr_spectrum" title="Link to this definition">#</a></dt>
<dd><p>Build arrays for plotting a spectrum phonon spectral function.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.multi_phonons.make_line_shape">
<span class="sig-prename descclassname"><span class="pre">hylight.multi_phonons.</span></span><span class="sig-name descname"><span class="pre">make_line_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_si</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.multi_phonons.make_line_shape" title="Link to this definition">#</a></dt>
<dd><p>Create the lineshape function in time space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – the time array (in s)</p></li>
<li><p><strong>sigma_si</strong> – the standard deviation of the line</p></li>
<li><p><strong>shape</strong> – the type of lineshape (an instance of <a class="reference internal" href="#hylight.multi_phonons.LineShape" title="hylight.multi_phonons.LineShape"><code class="xref py py-class docutils literal notranslate"><span class="pre">LineShape</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> of the same shape as <code class="code docutils literal notranslate"><span class="pre">t</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.multi_phonons.plot_spectral_function">
<span class="sig-prename descclassname"><span class="pre">hylight.multi_phonons.</span></span><span class="sig-name descname"><span class="pre">plot_spectral_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poscar_gs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poscar_es</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_phonons=&lt;function</span> <span class="pre">load_phonons&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cm1=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpl_params=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.multi_phonons.plot_spectral_function" title="Link to this definition">#</a></dt>
<dd><p>Plot a two panel representation of the spectral function of the distorsion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode_source</strong> – path to the mode file (by default a pickle file)</p></li>
<li><p><strong>poscar_gs</strong> – path to the file containing the ground state atomic positions.</p></li>
<li><p><strong>poscar_es</strong> – path to the file containing the excited state atomic positions.</p></li>
<li><p><strong>load_phonons</strong> – a function to read mode_source.</p></li>
<li><p><strong>use_cm1</strong> – use cm1 as the unit for frequency instead of meV.</p></li>
<li><p><strong>disp</strong> – standard deviation of the gaussians in background in meV.</p></li>
<li><p><strong>mpl_params</strong> – dictionary of kw parameters for pyplot.plot.</p></li>
<li><p><strong>mask</strong> – a mask used in other computations to show on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="code docutils literal notranslate"><span class="pre">(figure,</span> <span class="pre">(ax_FC,</span> <span class="pre">ax_S))</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.multi_phonons.rect">
<span class="sig-prename descclassname"><span class="pre">hylight.multi_phonons.</span></span><span class="sig-name descname"><span class="pre">rect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.multi_phonons.rect" title="Link to this definition">#</a></dt>
<dd><p>A dummy windowing function that works like numpy.hamming, but as no effect on data.</p>
</dd></dl>

</section>
<section id="module-hylight.npz">
<span id="hylight-npz-module"></span><h2>hylight.npz module<a class="headerlink" href="#module-hylight.npz" title="Link to this heading">#</a></h2>
<p>Serialization of modes to numpy zipped file.</p>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.savez()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.load()</span></code>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="hylight.npz.archive_modes">
<span class="sig-prename descclassname"><span class="pre">hylight.npz.</span></span><span class="sig-name descname"><span class="pre">archive_modes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.npz.archive_modes" title="Link to this definition">#</a></dt>
<dd><p>Store modes in dest using numpy’s npz format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>modes</strong> – a list of Mode objects.</p></li>
<li><p><strong>dest</strong> – the path to write the modes to.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the data returned by load_phonons.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.npz.load_phonons">
<span class="sig-prename descclassname"><span class="pre">hylight.npz.</span></span><span class="sig-name descname"><span class="pre">load_phonons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.npz.load_phonons" title="Link to this definition">#</a></dt>
<dd><p>Load modes from a Hylight archive.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.npz.pops_and_masses">
<span class="sig-prename descclassname"><span class="pre">hylight.npz.</span></span><span class="sig-name descname"><span class="pre">pops_and_masses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.npz.pops_and_masses" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-hylight.struct">
<span id="hylight-struct-module"></span><h2>hylight.struct module<a class="headerlink" href="#module-hylight.struct" title="Link to this heading">#</a></h2>
<p>A generic representation of a crystal cell.</p>
<dl class="py class">
<dt class="sig sig-object py" id="hylight.struct.Struct">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hylight.struct.</span></span><span class="sig-name descname"><span class="pre">Struct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.struct.Struct" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A general description of a periodic crystal cell.</p>
<p>Store all the required infos to describe a given set of atomic positions.</p>
<dl class="py property">
<dt class="sig sig-object py" id="hylight.struct.Struct.atoms">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atoms</span></span><a class="headerlink" href="#hylight.struct.Struct.atoms" title="Link to this definition">#</a></dt>
<dd><p>List the species names in an order matching <cite>self.raw</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.struct.Struct.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#hylight.struct.Struct" title="hylight.struct.Struct"><span class="pre">Struct</span></a></span></span><a class="headerlink" href="#hylight.struct.Struct.copy" title="Link to this definition">#</a></dt>
<dd><p>Return a copy of the structure.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.struct.Struct.from_mode">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#hylight.mode.Mode" title="hylight.mode.Mode"><span class="pre">Mode</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#hylight.struct.Struct" title="hylight.struct.Struct"><span class="pre">Struct</span></a></span></span><a class="headerlink" href="#hylight.struct.Struct.from_mode" title="Link to this definition">#</a></dt>
<dd><p>Extract the cell from a <a class="reference internal" href="#hylight.mode.Mode" title="hylight.mode.Mode"><code class="xref py py-class docutils literal notranslate"><span class="pre">hylight.mode.Mode</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.struct.Struct.get_offset">
<span class="sig-name descname"><span class="pre">get_offset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.struct.Struct.get_offset" title="Link to this definition">#</a></dt>
<dd><p>Return the index offset of the given species block in <a class="reference internal" href="#hylight.struct.Struct.raw" title="hylight.struct.Struct.raw"><code class="xref py py-attr docutils literal notranslate"><span class="pre">raw</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hylight.struct.Struct.raw">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">raw</span></span><a class="headerlink" href="#hylight.struct.Struct.raw" title="Link to this definition">#</a></dt>
<dd><p>Return an array of atomic positions.</p>
<p>This can be modified overwritten, but not modified in place.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hylight.struct.Struct.sp_at">
<span class="sig-name descname"><span class="pre">sp_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.struct.Struct.sp_at" title="Link to this definition">#</a></dt>
<dd><p>Return the name of the species at the given index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>i</strong> – the index of the atom.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the name of the species.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hylight.struct.Struct.species_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">species_names</span></span><a class="headerlink" href="#hylight.struct.Struct.species_names" title="Link to this definition">#</a></dt>
<dd><p>Names of species in the same order as found in the raw positions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hylight.struct.Struct.system_name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">system_name</span></span><a class="headerlink" href="#hylight.struct.Struct.system_name" title="Link to this definition">#</a></dt>
<dd><p>The name of the system, eventually generated from formula.</p>
<p>Can be overwritten.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-hylight.typing">
<span id="hylight-typing-module"></span><h2>hylight.typing module<a class="headerlink" href="#module-hylight.typing" title="Link to this heading">#</a></h2>
<p>Helper module for type annotations.</p>
<p>Should help with variable support of typing across versions of python and libraries.</p>
</section>
<section id="module-hylight.utils">
<span id="hylight-utils-module"></span><h2>hylight.utils module<a class="headerlink" href="#module-hylight.utils" title="Link to this heading">#</a></h2>
<p>Pervasive utilities.</p>
<dl class="py exception">
<dt class="sig sig-object py" id="hylight.utils.InputError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hylight.utils.</span></span><span class="sig-name descname"><span class="pre">InputError</span></span><a class="headerlink" href="#hylight.utils.InputError" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code></p>
<p>An exception raised when the input files are not as expected.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.utils.gaussian">
<span class="sig-prename descclassname"><span class="pre">hylight.utils.</span></span><span class="sig-name descname"><span class="pre">gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.utils.gaussian" title="Link to this definition">#</a></dt>
<dd><p>Evaluate a Gaussian function on e.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e</strong> – abscissa</p></li>
<li><p><strong>sigma</strong> – standard deviation</p></li>
<li><p><strong>standard</strong> – <ul>
<li><p>if True the curve is normalized to have an area of 1</p></li>
<li><p>if False the curve is normalized to have a maximum of 1</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.utils.gen_translat">
<span class="sig-prename descclassname"><span class="pre">hylight.utils.</span></span><span class="sig-name descname"><span class="pre">gen_translat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lattice</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.utils.gen_translat" title="Link to this definition">#</a></dt>
<dd><p>Generate all translations to adjacent cells</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lattice</strong> – np.ndarray([a, b, c]) first lattice parameter</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.utils.measure_fwhm">
<span class="sig-prename descclassname"><span class="pre">hylight.utils.</span></span><span class="sig-name descname"><span class="pre">measure_fwhm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.utils.measure_fwhm" title="Link to this definition">#</a></dt>
<dd><p>Measure the full width at half maximum of a given spectrum.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It may fail if there are more than one band that reach half
maximum in the array. In this case you may want to use
select_interval to make a window around a single band.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – the energy array</p></li>
<li><p><strong>y</strong> – the intensity array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>FWHM in the same unit as x.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.utils.parse_formatted_table">
<span class="sig-prename descclassname"><span class="pre">hylight.utils.</span></span><span class="sig-name descname"><span class="pre">parse_formatted_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lines</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.utils.parse_formatted_table" title="Link to this definition">#</a></dt>
<dd><p>Parse a table of numbers from a list of string with a regex.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lines</strong> – a list of string representing the lines of the table</p></li>
<li><p><strong>format</strong> – a re.Pattern or a str representing the format of the line
It should fullmatch each line or a ValueError exception will be raised.
All the groups defined in format will be converted to float64 by numpy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a np.array of dimension (len(lines), {number_of_groups})</p>
</dd>
</dl>
<section id="example">
<h3>Example:<a class="headerlink" href="#example" title="Link to this heading">#</a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parse_formatted_table</span><span class="p">([</span><span class="s2">&quot;a=0.56 b=0.8 c=0.9&quot;</span><span class="p">],</span> <span class="s2">&quot;a=(.*) b=(.*) c=(.*)&quot;</span><span class="p">)</span>
<span class="go">np.array([[0.56, 0.8, 0.9]])</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.utils.periodic_diff">
<span class="sig-prename descclassname"><span class="pre">hylight.utils.</span></span><span class="sig-name descname"><span class="pre">periodic_diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.utils.periodic_diff" title="Link to this definition">#</a></dt>
<dd><p>Compute the displacement between ref and disp, accounting for periodic conditions.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.utils.periodic_dist">
<span class="sig-prename descclassname"><span class="pre">hylight.utils.</span></span><span class="sig-name descname"><span class="pre">periodic_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.utils.periodic_dist" title="Link to this definition">#</a></dt>
<dd><p>Compute the distance between ref and disp, accounting for periodic conditions.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hylight.utils.select_interval">
<span class="sig-prename descclassname"><span class="pre">hylight.utils.</span></span><span class="sig-name descname"><span class="pre">select_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hylight.utils.select_interval" title="Link to this definition">#</a></dt>
<dd><p>Extract an interval of a spectrum and return the windows x and y arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – x array</p></li>
<li><p><strong>y</strong> – y array</p></li>
<li><p><strong>emin</strong> – lower bound for the window</p></li>
<li><p><strong>emax</strong> – higher bound for the window</p></li>
<li><p><strong>normalize</strong> – if true, the result y array is normalized</p></li>
<li><p><strong>npoints</strong> – if an integer, the result arrays will be
interpolated to contains exactly npoints linearly distributed
between emin and emax.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="code docutils literal notranslate"><span class="pre">(windowed_x,</span> <span class="pre">windowed_y)</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="hylight.crystal.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">hylight.crystal package</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../tutorial/tutorial.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">BaZrO3:Ti study</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div>
              <a href="https://creativecommons.org/licenses/by/4.0/" >
                  <img src="../_static/by.svg" border="0" alt="Creative Commons License"/>
              </a>
          </div>
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, The PyDEF team
            </div>
            This document is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">hylight package</a><ul>
<li><a class="reference internal" href="#hylight.setup_logging"><code class="docutils literal notranslate"><span class="pre">setup_logging()</span></code></a></li>
<li><a class="reference internal" href="#module-hylight.constants">hylight.constants module</a></li>
<li><a class="reference internal" href="#module-hylight.guess_width">hylight.guess_width module</a><ul>
<li><a class="reference internal" href="#hylight.guess_width.OmegaEff"><code class="docutils literal notranslate"><span class="pre">OmegaEff</span></code></a><ul>
<li><a class="reference internal" href="#hylight.guess_width.OmegaEff.DISP"><code class="docutils literal notranslate"><span class="pre">OmegaEff.DISP</span></code></a></li>
<li><a class="reference internal" href="#hylight.guess_width.OmegaEff.FC_MEAN"><code class="docutils literal notranslate"><span class="pre">OmegaEff.FC_MEAN</span></code></a></li>
<li><a class="reference internal" href="#hylight.guess_width.OmegaEff.FC_RMS"><code class="docutils literal notranslate"><span class="pre">OmegaEff.FC_RMS</span></code></a></li>
<li><a class="reference internal" href="#hylight.guess_width.OmegaEff.GRAD"><code class="docutils literal notranslate"><span class="pre">OmegaEff.GRAD</span></code></a></li>
<li><a class="reference internal" href="#hylight.guess_width.OmegaEff.HR_MEAN"><code class="docutils literal notranslate"><span class="pre">OmegaEff.HR_MEAN</span></code></a></li>
<li><a class="reference internal" href="#hylight.guess_width.OmegaEff.HR_RMS"><code class="docutils literal notranslate"><span class="pre">OmegaEff.HR_RMS</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#hylight.guess_width.WidthModel"><code class="docutils literal notranslate"><span class="pre">WidthModel</span></code></a><ul>
<li><a class="reference internal" href="#hylight.guess_width.WidthModel.FULL_ND"><code class="docutils literal notranslate"><span class="pre">WidthModel.FULL_ND</span></code></a></li>
<li><a class="reference internal" href="#hylight.guess_width.WidthModel.ONED"><code class="docutils literal notranslate"><span class="pre">WidthModel.ONED</span></code></a></li>
<li><a class="reference internal" href="#hylight.guess_width.WidthModel.SINGLE_ES_FREQ"><code class="docutils literal notranslate"><span class="pre">WidthModel.SINGLE_ES_FREQ</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#hylight.guess_width.duschinsky"><code class="docutils literal notranslate"><span class="pre">duschinsky()</span></code></a></li>
<li><a class="reference internal" href="#hylight.guess_width.effective_phonon_energy"><code class="docutils literal notranslate"><span class="pre">effective_phonon_energy()</span></code></a></li>
<li><a class="reference internal" href="#hylight.guess_width.expected_width"><code class="docutils literal notranslate"><span class="pre">expected_width()</span></code></a></li>
<li><a class="reference internal" href="#hylight.guess_width.gradiant_at"><code class="docutils literal notranslate"><span class="pre">gradiant_at()</span></code></a></li>
<li><a class="reference internal" href="#hylight.guess_width.guess_width"><code class="docutils literal notranslate"><span class="pre">guess_width()</span></code></a></li>
<li><a class="reference internal" href="#hylight.guess_width.integrate"><code class="docutils literal notranslate"><span class="pre">integrate()</span></code></a></li>
<li><a class="reference internal" href="#hylight.guess_width.sigma"><code class="docutils literal notranslate"><span class="pre">sigma()</span></code></a></li>
<li><a class="reference internal" href="#hylight.guess_width.sigma_full_nd"><code class="docutils literal notranslate"><span class="pre">sigma_full_nd()</span></code></a></li>
<li><a class="reference internal" href="#hylight.guess_width.sigma_hybrid"><code class="docutils literal notranslate"><span class="pre">sigma_hybrid()</span></code></a></li>
<li><a class="reference internal" href="#hylight.guess_width.variance"><code class="docutils literal notranslate"><span class="pre">variance()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-hylight.loader">hylight.loader module</a></li>
<li><a class="reference internal" href="#module-hylight.mode">hylight.mode module</a><ul>
<li><a class="reference internal" href="#hylight.mode.CellMismatch"><code class="docutils literal notranslate"><span class="pre">CellMismatch</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mask"><code class="docutils literal notranslate"><span class="pre">Mask</span></code></a><ul>
<li><a class="reference internal" href="#hylight.mode.Mask.accept"><code class="docutils literal notranslate"><span class="pre">Mask.accept()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mask.add_interval"><code class="docutils literal notranslate"><span class="pre">Mask.add_interval()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mask.as_bool"><code class="docutils literal notranslate"><span class="pre">Mask.as_bool()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mask.from_bias"><code class="docutils literal notranslate"><span class="pre">Mask.from_bias()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mask.plot"><code class="docutils literal notranslate"><span class="pre">Mask.plot()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mask.reject"><code class="docutils literal notranslate"><span class="pre">Mask.reject()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#hylight.mode.Mode"><code class="docutils literal notranslate"><span class="pre">Mode</span></code></a><ul>
<li><a class="reference internal" href="#hylight.mode.Mode.energies"><code class="docutils literal notranslate"><span class="pre">Mode.energies()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mode.energy_cm1"><code class="docutils literal notranslate"><span class="pre">Mode.energy_cm1</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mode.energy_eV"><code class="docutils literal notranslate"><span class="pre">Mode.energy_eV</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mode.energy_meV"><code class="docutils literal notranslate"><span class="pre">Mode.energy_meV</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mode.energy_si"><code class="docutils literal notranslate"><span class="pre">Mode.energy_si</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mode.huang_rhys"><code class="docutils literal notranslate"><span class="pre">Mode.huang_rhys()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mode.localization_ratio"><code class="docutils literal notranslate"><span class="pre">Mode.localization_ratio()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mode.participation_ratio"><code class="docutils literal notranslate"><span class="pre">Mode.participation_ratio()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mode.per_species_n_eff"><code class="docutils literal notranslate"><span class="pre">Mode.per_species_n_eff()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mode.per_species_pr"><code class="docutils literal notranslate"><span class="pre">Mode.per_species_pr()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mode.project"><code class="docutils literal notranslate"><span class="pre">Mode.project()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mode.project_coef2"><code class="docutils literal notranslate"><span class="pre">Mode.project_coef2()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mode.project_coef2_R"><code class="docutils literal notranslate"><span class="pre">Mode.project_coef2_R()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mode.set_lattice"><code class="docutils literal notranslate"><span class="pre">Mode.set_lattice()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mode.to_jmol"><code class="docutils literal notranslate"><span class="pre">Mode.to_jmol()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.Mode.to_traj"><code class="docutils literal notranslate"><span class="pre">Mode.to_traj()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#hylight.mode.angle"><code class="docutils literal notranslate"><span class="pre">angle()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.dynamical_matrix"><code class="docutils literal notranslate"><span class="pre">dynamical_matrix()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.generate_basis"><code class="docutils literal notranslate"><span class="pre">generate_basis()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.get_HR_factors"><code class="docutils literal notranslate"><span class="pre">get_HR_factors()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.get_energies"><code class="docutils literal notranslate"><span class="pre">get_energies()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.modes_from_dynmat"><code class="docutils literal notranslate"><span class="pre">modes_from_dynmat()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.orthonormalize"><code class="docutils literal notranslate"><span class="pre">orthonormalize()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.project_on_asr"><code class="docutils literal notranslate"><span class="pre">project_on_asr()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.rot_c_to_v"><code class="docutils literal notranslate"><span class="pre">rot_c_to_v()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mode.same_cell"><code class="docutils literal notranslate"><span class="pre">same_cell()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-hylight.mono_phonon">hylight.mono_phonon module</a><ul>
<li><a class="reference internal" href="#hylight.mono_phonon.compute_spectrum"><code class="docutils literal notranslate"><span class="pre">compute_spectrum()</span></code></a></li>
<li><a class="reference internal" href="#hylight.mono_phonon.huang_rhys"><code class="docutils literal notranslate"><span class="pre">huang_rhys()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-hylight.multi_phonons">hylight.multi_phonons module</a><ul>
<li><a class="reference internal" href="#hylight.multi_phonons.LineShape"><code class="docutils literal notranslate"><span class="pre">LineShape</span></code></a><ul>
<li><a class="reference internal" href="#hylight.multi_phonons.LineShape.GAUSSIAN"><code class="docutils literal notranslate"><span class="pre">LineShape.GAUSSIAN</span></code></a></li>
<li><a class="reference internal" href="#hylight.multi_phonons.LineShape.LORENTZIAN"><code class="docutils literal notranslate"><span class="pre">LineShape.LORENTZIAN</span></code></a></li>
<li><a class="reference internal" href="#hylight.multi_phonons.LineShape.NONE"><code class="docutils literal notranslate"><span class="pre">LineShape.NONE</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#hylight.multi_phonons.compute_delta_R"><code class="docutils literal notranslate"><span class="pre">compute_delta_R()</span></code></a></li>
<li><a class="reference internal" href="#hylight.multi_phonons.compute_spectrum"><code class="docutils literal notranslate"><span class="pre">compute_spectrum()</span></code></a></li>
<li><a class="reference internal" href="#hylight.multi_phonons.duschinsky"><code class="docutils literal notranslate"><span class="pre">duschinsky()</span></code></a></li>
<li><a class="reference internal" href="#hylight.multi_phonons.dynmatshow"><code class="docutils literal notranslate"><span class="pre">dynmatshow()</span></code></a></li>
<li><a class="reference internal" href="#hylight.multi_phonons.fc_spectrum"><code class="docutils literal notranslate"><span class="pre">fc_spectrum()</span></code></a></li>
<li><a class="reference internal" href="#hylight.multi_phonons.freq_from_finite_diff"><code class="docutils literal notranslate"><span class="pre">freq_from_finite_diff()</span></code></a></li>
<li><a class="reference internal" href="#hylight.multi_phonons.hr_spectrum"><code class="docutils literal notranslate"><span class="pre">hr_spectrum()</span></code></a></li>
<li><a class="reference internal" href="#hylight.multi_phonons.make_line_shape"><code class="docutils literal notranslate"><span class="pre">make_line_shape()</span></code></a></li>
<li><a class="reference internal" href="#hylight.multi_phonons.plot_spectral_function"><code class="docutils literal notranslate"><span class="pre">plot_spectral_function()</span></code></a></li>
<li><a class="reference internal" href="#hylight.multi_phonons.rect"><code class="docutils literal notranslate"><span class="pre">rect()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-hylight.npz">hylight.npz module</a><ul>
<li><a class="reference internal" href="#hylight.npz.archive_modes"><code class="docutils literal notranslate"><span class="pre">archive_modes()</span></code></a></li>
<li><a class="reference internal" href="#hylight.npz.load_phonons"><code class="docutils literal notranslate"><span class="pre">load_phonons()</span></code></a></li>
<li><a class="reference internal" href="#hylight.npz.pops_and_masses"><code class="docutils literal notranslate"><span class="pre">pops_and_masses()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-hylight.struct">hylight.struct module</a><ul>
<li><a class="reference internal" href="#hylight.struct.Struct"><code class="docutils literal notranslate"><span class="pre">Struct</span></code></a><ul>
<li><a class="reference internal" href="#hylight.struct.Struct.atoms"><code class="docutils literal notranslate"><span class="pre">Struct.atoms</span></code></a></li>
<li><a class="reference internal" href="#hylight.struct.Struct.copy"><code class="docutils literal notranslate"><span class="pre">Struct.copy()</span></code></a></li>
<li><a class="reference internal" href="#hylight.struct.Struct.from_mode"><code class="docutils literal notranslate"><span class="pre">Struct.from_mode()</span></code></a></li>
<li><a class="reference internal" href="#hylight.struct.Struct.get_offset"><code class="docutils literal notranslate"><span class="pre">Struct.get_offset()</span></code></a></li>
<li><a class="reference internal" href="#hylight.struct.Struct.raw"><code class="docutils literal notranslate"><span class="pre">Struct.raw</span></code></a></li>
<li><a class="reference internal" href="#hylight.struct.Struct.sp_at"><code class="docutils literal notranslate"><span class="pre">Struct.sp_at()</span></code></a></li>
<li><a class="reference internal" href="#hylight.struct.Struct.species_names"><code class="docutils literal notranslate"><span class="pre">Struct.species_names</span></code></a></li>
<li><a class="reference internal" href="#hylight.struct.Struct.system_name"><code class="docutils literal notranslate"><span class="pre">Struct.system_name</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-hylight.typing">hylight.typing module</a></li>
<li><a class="reference internal" href="#module-hylight.utils">hylight.utils module</a><ul>
<li><a class="reference internal" href="#hylight.utils.InputError"><code class="docutils literal notranslate"><span class="pre">InputError</span></code></a></li>
<li><a class="reference internal" href="#hylight.utils.gaussian"><code class="docutils literal notranslate"><span class="pre">gaussian()</span></code></a></li>
<li><a class="reference internal" href="#hylight.utils.gen_translat"><code class="docutils literal notranslate"><span class="pre">gen_translat()</span></code></a></li>
<li><a class="reference internal" href="#hylight.utils.measure_fwhm"><code class="docutils literal notranslate"><span class="pre">measure_fwhm()</span></code></a></li>
<li><a class="reference internal" href="#hylight.utils.parse_formatted_table"><code class="docutils literal notranslate"><span class="pre">parse_formatted_table()</span></code></a></li>
<li><a class="reference internal" href="#hylight.utils.periodic_diff"><code class="docutils literal notranslate"><span class="pre">periodic_diff()</span></code></a></li>
<li><a class="reference internal" href="#hylight.utils.periodic_dist"><code class="docutils literal notranslate"><span class="pre">periodic_dist()</span></code></a></li>
<li><a class="reference internal" href="#hylight.utils.select_interval"><code class="docutils literal notranslate"><span class="pre">select_interval()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=8d563738"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]]}, "svg": {"fontCache": "global"}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>